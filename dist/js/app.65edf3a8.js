(function(){"use strict";var t={2892:function(t,e,s){var i=s(6369),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("h1",[t._v("Order Book")]),t.sell.length?e("div",{staticClass:"table sell"},[t._m(0),t._l(t.sell,(function(s,i){return e("div",{key:`sell-${i}`,staticClass:"td",class:{new:s.isNew}},[e("div",{staticClass:"price"},[t._v(t._s(t._f("NumWithDigitsFormat")(s.price)))]),e("div",{key:s.size_change,staticClass:"size",class:s.size_change},[t._v(" "+t._s(t._f("NumFormat")(s.size))+" ")]),e("div",{staticClass:"total"},[e("span",{staticClass:"bar",style:t.setPercent(s.total,"sell")}),t._v(" "+t._s(t._f("NumFormat")(s.total))+" ")])])}))],2):t._e(),e("div",{staticClass:"current",class:t.currentType},[t._v(" "+t._s(t._f("NumFormat")(t.currentPrice.price))+" "),"equal"!==t.currentType?e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",fill:"none","fill-rule":"nonzero",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}},[e("line",{attrs:{x1:"12",y1:"5",x2:"12",y2:"19"}}),e("polyline",{attrs:{points:"19 12 12 19 5 12"}})]):t._e()]),t.buy.length?e("div",{staticClass:"table buy"},t._l(t.buy,(function(s,i){return e("div",{key:`buy-${i}`,staticClass:"td",class:{new:s.isNew}},[e("div",{staticClass:"price"},[t._v(t._s(t._f("NumWithDigitsFormat")(s.price)))]),e("div",{staticClass:"size",class:s.size_change},[t._v(" "+t._s(t._f("NumFormat")(s.size))+" ")]),e("div",{staticClass:"total"},[e("span",{staticClass:"bar",style:t.setPercent(s.total,"buy")}),t._v(" "+t._s(t._f("NumFormat")(s.total))+" ")])])})),0):t._e()])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"tr"},[e("div",[t._v("Price(USD)")]),e("div",[t._v("Size")]),e("div",[t._v("Total")])])}],o={name:"App",data(){return{sell:[{price:21699,size:3691,total:5657},{price:21693.5,size:461,total:1966},{price:21680.5,size:53,total:1505},{price:21680,size:836,total:1452},{price:21672,size:40,total:616},{price:21669,size:210,total:576},{price:21665.5,size:331,total:366},{price:21665,size:35,total:35}],buy:[{price:21699,size:3691,total:5657},{price:21693.5,size:461,total:1966},{price:21680.5,size:53,total:1505},{price:21680,size:836,total:1452},{price:21672,size:40,total:616},{price:21669,size:210,total:576},{price:21665.5,size:331,total:366},{price:21665,size:35,total:35}],initQuote:{sell:[],buy:[]},currentPrice:{},currentType:"equal",quoteWs:null,priceWs:null}},filters:{NumWithDigitsFormat(t){return Number(parseFloat(t).toFixed(3)).toLocaleString("en",{minimumFractionDigits:1})},NumFormat(t){return Number(parseFloat(t).toFixed(3)).toLocaleString("en",{minimumFractionDigits:0})}},watch:{currentPrice:{handler(t,e){this.currentType=t.price<e.price?"rise":t.price>e.price?"fall":"equal"},deep:!0}},created(){this.initWs("quote"),this.initWs("price")},methods:{getQuoteData(t){"snapshot"===t.data.type?(this.buy=this.setInitData("buy",t.data.bids),this.sell=this.setInitData("sell",t.data.asks)):"delta"===t.data.type?t.data.bids.length>0&&(this.buy=this.updateQuote("buy",t.data.bids),this.sell=this.updateQuote("sell",t.data.asks)):this.wsSend({op:"unsubscribe",args:["update:BTCPFC"]})},initWs(t){let e="";"quote"===t?(e="wss://ws.btse.com/ws/oss/futures",this.quoteWs=new WebSocket(e),this.quoteWs.onopen=this.wsOnOpenQuote,this.quoteWs.error=this.wsOnError,this.quoteWs.onmessage=this.wsOnMessage,this.quoteWs.onclose=this.wsCloseQuote):(e="wss://ws.btse.com/ws/futures",this.priceWs=new WebSocket(e),this.priceWs.onopen=this.wsOnOpenPrice,this.priceWs.error=this.wsOnError,this.priceWs.onmessage=this.wsOnMessage,this.priceWs.onclose=this.wsClosePrice)},wsOnOpenQuote(){this.wsSend("quote",{op:"subscribe",args:["update:BTCPFC"]})},wsOnOpenPrice(){this.wsSend("price",{op:"subscribe",args:["tradeHistoryApi:BTCPFC"]})},wsOnError(t){console.error("ws 連線失敗",t)},wsOnMessage(t){const e=JSON.parse(t.data);"update:BTCPFC"===e.topic?this.getQuoteData(e):"tradeHistoryApi"===e.topic&&(this.currentPrice=e.data[0])},wsSend(t,e){"quote"===t?this.quoteWs.send(JSON.stringify(e)):this.priceWs.send(JSON.stringify(e))},wsCloseQuote(){this.wsSend({op:"unsubscribe",args:["update:BTCPFC"]}),console.log("ws 關閉 Quote 連線")},wsClosePrice(){this.wsSend({op:"unsubscribe",args:["tradeHistoryApi:BTCPFC"]}),console.log("ws 關閉 Price 連線")},setInitData(t,e){const s=e.sort(((t,e)=>t[0]-e[0]));let i=[];s.forEach((e=>{i.push({price:Number(e[0]),size:Number(e[1]),total:0,size_change:"equal",isNew:!1}),this.initQuote[t].push({price:Number(e[0]),size:Number(e[1]),total:0,size_change:"equal",isNew:!1})})),i.splice(0,42);let r=0;return i.forEach((t=>{r+=Number(t.size),t.total=r})),"sell"===t&&(i=i.sort(((t,e)=>e.price-t.price))),i},setPercent(t,e){let s=0;return s="sell"===e?Math.floor(Number(t)/this.sell[0].total*100):s=Math.floor(Number(t)/this.buy[7].total*100),{width:s+"%"}},updateQuote(t,e){this.initQuote[t].forEach((t=>{t.isNew=!1,t.size_change="equal"})),e.forEach((e=>{const s=this.initQuote[t].findIndex((t=>t.price===Number(e[0])));if(-1===s)this.initQuote[t].push({price:Number(e[0]),size:Number(e[1]),total:0,size_change:"equal",isNew:!0});else{if(0===Number(e[1]))return void this.initQuote[t].splice(s,1);this.initQuote[t][s].size>Number(e[1])&&(this.initQuote[t][s].size_change="fall"),this.initQuote[t][s].size<Number(e[1])&&(this.initQuote[t][s].size_change="rise"),this.initQuote[t][s].size=Number(e[1])}})),this.initQuote[t]=this.initQuote[t].filter((t=>0!==t.size)),this.initQuote[t]=this.initQuote[t].sort(((t,e)=>t.price-e.price)),this.initQuote[t].length>50&&this.initQuote[t].splice(0,this.initQuote[t].length-50);const s=JSON.parse(JSON.stringify(this.initQuote[t]));s.length>8&&s.splice(0,s.length-8);let i=0;return s.forEach((t=>{i+=Number(t.size),t.total=i})),"sell"===t&&s.sort(((t,e)=>e.price-t.price)),s}},destroy(){this.wsCloseQuote(),this.wsClosePrice()}},a=o,u=s(1001),l=(0,u.Z)(a,r,n,!1,null,null,null),c=l.exports;i.ZP.config.productionTip=!1,new i.ZP({render:t=>t(c)}).$mount("#app")}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,i,r,n){if(!i){var o=1/0;for(c=0;c<t.length;c++){i=t[c][0],r=t[c][1],n=t[c][2];for(var a=!0,u=0;u<i.length;u++)(!1&n||o>=n)&&Object.keys(s.O).every((function(t){return s.O[t](i[u])}))?i.splice(u--,1):(a=!1,n<o&&(o=n));if(a){t.splice(c--,1);var l=r();void 0!==l&&(e=l)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[i,r,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var r,n,o=i[0],a=i[1],u=i[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(u)var c=u(s)}for(e&&e(i);l<o.length;l++)n=o[l],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(c)},i=self["webpackChunknogle_test"]=self["webpackChunknogle_test"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(2892)}));i=s.O(i)})();
//# sourceMappingURL=app.65edf3a8.js.map